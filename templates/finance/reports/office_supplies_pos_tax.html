{% extends "base.html" %}
{% load crispy_forms_tags %}
{% load static %}
<script src="{% static 'js/datepicker.js' %}"></script>

{% block content %}
<style>
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
    font-family: sans-serif;
  }

  th, td {
    border: 1px solid #ccc;
    padding: 12px;
    text-align: left;
  }

  th {
    background-color: #f2f2f2;
  }

  td {
    background-color: #fafafa;
  }
</style>

<h3>Office Supplies POS â€” Sales Tax Payable</h3>

<form method="post">
  {% csrf_token %}
  {{ form.as_p }}
  <button type="submit">Submit</button>
</form>

{% if sales %}
  <p>
    <table>
      <tr>
        <th>Invoice Total</th>
        <th>Taxable sales</th>
        <th>Tax received</th>
        <th>Exempt sales</th>
      </tr>
      <tr>
        <td>{{ invoice_total|floatformat:2 }}</td>
        <td>{{ taxable|floatformat:2 }}</td>
        <td>{{ total_tax|floatformat:2 }}</td>
        <td>{{ exemptions|floatformat:2 }}</td>
      </tr>
    </table>

    <table>
      <tr>
        <th>Date</th>
        <th>Customer</th>
        <th>Sale #</th>
        <th>Subtotal</th>
        <th>Tax</th>
        <th>Invoice Total</th>
      </tr>
      {% for s in sales %}
      <tr>
        <td>{{ s.created_at|date:"M d, Y" }}</td>
        <td>{{ s.customer.company_name }}</td>
        <td>{{ s.sale.id }}</td>
        <td>{{ s.subtotal|floatformat:2 }}</td>
        <td>{{ s.tax|floatformat:2 }}</td>
        <td>{{ s.total|floatformat:2 }}</td>
      </tr>
      {% endfor %}
    </table>

    Exemptions:
    <table>
      <tr>
        <th>Date</th>
        <th>Customer</th>
        <th>Sale #</th>
        <th>Subtotal</th>
        <th>Tax</th>
        <th>Invoice Total</th>
      </tr>
      {% for s in sales %}
        {% if not s.tax or s.tax <= 0 %}
        <tr>
          <td>{{ s.created_at|date:"M d, Y" }}</td>
          <td>{{ s.customer.company_name }}</td>
          <td>{{ s.sale.id }}</td>
          <td>{{ s.subtotal|floatformat:2 }}</td>
          <td>{{ s.tax|floatformat:2 }}</td>
          <td>{{ s.total|floatformat:2 }}</td>
        </tr>
        {% endif %}
      {% endfor %}
    </table>
  </p>
{% endif %}

<div id="modal" class="modal fade">
  <div id="dialog" class="modal-dialog" hx-target="this"></div>
</div>

<div id="modal2" class="modal fade">
  <div id="dialog2" class="modal-dialog modal-lg" hx-target="this"></div>
</div>

{% endblock content %}

{% block scripts %}
<script>
  $(function() {
    $(".datepicker").datepicker({
      dateFormat: "yy-mm-dd"
    });
  });
</script>
{% endblock %}