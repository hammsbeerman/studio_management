<div class="modal-content">
  <div class="modal-header">
    <h5 class="modal-title">Force Apply Payment #{{ payment.id }} — {{ customer.company_name }}</h5>
    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
  </div>

  <div class="modal-body">
    {% if error %}
      <div class="alert alert-danger">{{ error }}</div>
    {% endif %}

    <div class="text-muted mb-2">
      Amount: <strong>{{ payment.amount|floatformat:2 }}</strong>
      • Available: <strong>{{ payment.available|default_if_none:0|floatformat:2 }}</strong>
    </div>

    <form hx-post="{% url 'finance:orphan_payment_force_apply_modal' payment.id %}"
          hx-headers='{"X-CSRFToken":"{{ csrf_token }}"}'
          hx-swap="none">
      <div class="row g-2">
        <div class="col-md-6">
          <label class="form-label">Workorder</label>
          <select class="form-select" name="workorder" required>
            <option value="">Select workorder</option>
            {% for wo in workorders %}
              <option value="{{ wo.id }}">
                WO {{ wo.workorder }} — Open {{ wo.open_balance|floatformat:2 }} — {{ wo.description }}
              </option>
            {% endfor %}
          </select>
        </div>

        <div class="col-md-3">
          <label class="form-label">Date</label>
          <input class="form-control" type="date" name="date" value="{{ default_date|date:'Y-m-d' }}">
        </div>

        <div class="col-md-3">
          <label class="form-label">Amount</label>
          <input class="form-control" type="number" step="0.01" name="amount"
                 value="{{ payment.amount|floatformat:2 }}" required>
        </div>
      </div>

      <div class="mt-3 d-flex justify-content-end gap-2">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <button type="submit" class="btn btn-primary">Force apply</button>
      </div>
    </form>
  </div>
</div>
