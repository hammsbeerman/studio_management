<div class="modal-content">
  <div class="modal-header">
    <h5 class="modal-title">Issue Gift Certificate{% if customer %} — {{ customer.company_name }}{% endif %}</h5>
    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
  </div>

  <form
    hx-post="{% url 'finance:giftcertificate_issue' %}"
    hx-swap="none"
    hx-headers='{"X-CSRFToken":"{{ csrf_token }}"}'
  >
    <div class="modal-body">
      {% if customer %}
        <input type="hidden" name="customer" value="{{ customer.id }}">
      {% else %}
        <div class="alert alert-info mb-2">
          No customer selected — this gift certificate will be <strong>unassigned</strong> until first use.
        </div>
      {% endif %}

      <div class="row g-2">
        <div class="col-4">
          <label class="form-label">Issued Date</label>
          <input class="form-control" type="date" name="issued_date">
        </div>
        <div class="col-4">
          <label class="form-label">Certificate #</label>
          <input
            class="form-control"
            type="text"
            name="certificate_number"
            value="{{ next_number }}"
            readonly
          >
          <div class="form-text">Auto-generated</div>
        </div>
        <div class="col-4">
          <label class="form-label">Amount</label>
          <input class="form-control" type="number" step="0.01" name="amount" required>
        </div>
      </div>

      <div class="mt-2">
        <label class="form-label">Description</label>
        <input class="form-control" type="text" name="description">
      </div>

      <hr class="my-3">

      <div class="row g-2">
        <div class="col-6">
          <label class="form-label">Sold To (optional)</label>
          <input class="form-control" type="text" name="sold_to" placeholder="walk-in / name / phone">
        </div>
        <div class="col-6">
          <label class="form-label">Payment Type (optional)</label>
          <select class="form-select" name="sold_payment_type">
            <option value="">—</option>
            {% for pt in payment_types %}
              <option value="{{ pt.id }}">{{ pt.name }}</option>
            {% endfor %}
          </select>
        </div>
      </div>

      <div class="mt-2">
        <label class="form-label">Payment Reference (optional)</label>
        <input class="form-control" type="text" name="sold_reference" placeholder="check #, receipt #, note">
      </div>
    </div>

    <div class="modal-footer">
      <button class="btn btn-secondary" type="button" data-bs-dismiss="modal">Cancel</button>
      <button class="btn btn-primary" type="submit">Issue</button>
    </div>
  </form>
</div>
