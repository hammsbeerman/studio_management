{% extends "base.html" %}
{% block content %}
<h3>Merge Inventory Duplicates</h3>
<form method="post" hx-post="{% url 'inventory:merge_items' %}" hx-swap="outerHTML">
  {% csrf_token %}
  <div style="max-width:700px">
    <div class="mb-3">
      <label class="form-label">Keep (target)</label>
      {{ form.target }}
    </div>
    <div class="mb-3">
      <label class="form-label">Merge these</label>
      {{ form.duplicates }}
    </div>
    <div class="form-check mb-3">
      <label class="form-check-label">{{ form.prefer_target_name }} Keep target name</label>
    </div>
    <button class="btn btn-primary">Merge</button>
  </div>
</form>

<hr>
<h5>Recent merges</h5>
<ul>
  {% for l in logs %}
    <li>
      #{{ l.id }} — {{ l.at|date:"Y-m-d H:i" }} → kept {{ l.target }} (merged {{ l.merged_ids|length }})
      <a class="btn btn-link btn-sm" href="{% url 'inventory:undo_merge' l.id %}">Undo</a>
    </li>
  {% empty %}
    <li>No merges yet.</li>
  {% endfor %}
</ul>
{% endblock %}